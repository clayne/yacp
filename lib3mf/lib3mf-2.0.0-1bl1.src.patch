--- origsrc/lib3mf-2.0.0/AutomaticComponentToolkit/bin/act.cygwin	1970-01-01 09:00:00.000000000 +0900
+++ src/lib3mf-2.0.0/AutomaticComponentToolkit/bin/act.cygwin	2020-10-05 20:59:11.718406100 +0900
@@ -0,0 +1,3 @@
+#!/bin/bash
+current_dir=$(dirname $(readlink -f $0))
+${current_dir}/act.exe `cygpath -w $1`
--- origsrc/lib3mf-2.0.0/CMakeLists.txt	2019-09-26 21:18:48.000000000 +0900
+++ src/lib3mf-2.0.0/CMakeLists.txt	2020-10-06 07:55:26.819779800 +0900
@@ -53,6 +53,8 @@ endif()
 if(UNIX OR MINGW)
   if(APPLE)
     set(ACT_COMMANDENDING darwin)
+  elseif(CYGWIN)
+    set(ACT_COMMANDENDING cygwin)
   else()
     set(ACT_COMMANDENDING linux)
   endif()
@@ -146,6 +148,12 @@ add_library(${PROJECT_NAME} SHARED ${SRC
   ${VERSION_FILES_OUTPUTLOCATION}
 )
 SOURCE_GROUP("Source Files\\Autogenerated" FILES ${ACT_GENERATED_SOURCE})
+if (LIBZIP_FOUND)
+  target_link_libraries(${PROJECT_NAME} ${LIBZIP_LIBRARIES})
+endif()
+if (ZLIB_FOUND)
+  target_link_libraries(${PROJECT_NAME} ${ZLIB_LIBRARIES})
+endif()
 
 add_dependencies(${PROJECT_NAME} lib3mfACT)
 target_include_directories(${PROJECT_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR_AUTOGENERATED}/Source/Implementation)
@@ -198,3 +206,6 @@ if ("${CMAKE_CXX_COMPILER_ID}" STREQUAL
     set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} PROPERTY VS_STARTUP_PROJECT ${STARTUPPROJECT})
   ENDIF()
 endif()
+
+CONFIGURE_FILE(${CMAKE_SOURCE_DIR}/lib3mf.pc.in ${CMAKE_BINARY_DIR}/lib3mf.pc @ONLY)
+INSTALL(FILES ${CMAKE_BINARY_DIR}/lib3mf.pc DESTINATION ${CMAKE_INSTALL_PREFIX}/lib/pkgconfig)
--- origsrc/lib3mf-2.0.0/Source/CMakeLists.txt	2019-09-26 21:18:48.000000000 +0900
+++ src/lib3mf-2.0.0/Source/CMakeLists.txt	2020-10-06 07:58:49.275525700 +0900
@@ -1,10 +1,19 @@
+if (NOT (USE_INCLUDED_LIBZIP AND USE_INCLUDED_ZLIB))
+  find_package(PkgConfig)
+endif()
 
 if (USE_INCLUDED_LIBZIP)
   file(GLOB LIBZIP_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} "Source/Libraries/libzip/*.c")
+else()
+  pkg_check_modules(LIBZIP REQUIRED libzip)
+  set(LIBZIP_REQUIRES libzip)
 endif()
 
 if (USE_INCLUDED_ZLIB)
   file(GLOB ZLIB_FILES ./Source/Libraries/zlib/*.c)
+else()
+  pkg_check_modules(ZLIB REQUIRED zlib)
+  set(ZLIB_REQUIRES zlib)
 endif()
 
 
--- origsrc/lib3mf-2.0.0/Tests/CMakeLists.txt	2019-09-26 21:18:48.000000000 +0900
+++ src/lib3mf-2.0.0/Tests/CMakeLists.txt	2020-10-05 20:52:27.151900300 +0900
@@ -1,8 +1,13 @@
-ADD_SUBDIRECTORY (googletest EXCLUDE_FROM_ALL)
+find_package(GTest)
+if (NOT GTEST_FOUND)
+    ADD_SUBDIRECTORY (googletest EXCLUDE_FROM_ALL)
+endif()
 enable_testing()
 
-SET_TARGET_PROPERTIES (gtest PROPERTIES FOLDER gtest)
-SET_TARGET_PROPERTIES (gtest_main PROPERTIES FOLDER gtest)
+if (NOT GTEST_FOUND)
+    SET_TARGET_PROPERTIES (gtest PROPERTIES FOLDER gtest)
+    SET_TARGET_PROPERTIES (gtest_main PROPERTIES FOLDER gtest)
+endif()
 
 SET(gtest_SOURCE_DIR "${CMAKE_CURRENT_SOURCE_DIR}/googletest/googletest")
 add_definitions( -DTESTFILESPATH="${CMAKE_CURRENT_SOURCE_DIR}/TestFiles/")
--- origsrc/lib3mf-2.0.0/lib3MF.pc.in	2019-09-26 21:18:48.000000000 +0900
+++ src/lib3mf-2.0.0/lib3MF.pc.in	2020-10-06 08:00:07.271205300 +0900
@@ -1,12 +1,12 @@
 prefix=@CMAKE_INSTALL_PREFIX@
 exec_prefix=@CMAKE_INSTALL_PREFIX@
-libdir=${exec_prefix}/@CMAKE_INSTALL_LIBDIR@
-includedir=${prefix}/@CMAKE_INSTALL_INCLUDEDIR@
+libdir=@CMAKE_INSTALL_LIBDIR@
+includedir=@CMAKE_INSTALL_INCLUDEDIR@
 
 Name: @PROJECT_NAME@
 Description: @PROJECT_DESCRIPTION@
-Version: @PROJECT_VERSION@
+Version: @LIB3MF_VERSION_MAJOR@.@LIB3MF_VERSION_MINOR@.@LIB3MF_VERSION_MICRO@
 
-Requires:
-Libs: -L${libdir} -l3MF -lzip -lz
+Requires: @LIBZIP_REQUIRES@ @ZLIB_REQUIRES@
+Libs: -L${libdir} -l3mf
 Cflags: -I${includedir}
