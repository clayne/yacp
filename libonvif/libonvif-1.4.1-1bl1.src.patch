--- origsrc/libonvif-1.4.1/CMakeLists.txt	2022-12-01 04:36:28.000000000 +0900
+++ src/libonvif-1.4.1/CMakeLists.txt	2022-12-02 11:56:26.143927100 +0900
@@ -41,27 +41,29 @@ set(CMAKE_INSTALL_INCLUDEDIR "include/${
 
 find_package(LibXml2 REQUIRED)
 
-add_library(onvif_static STATIC 
-    libonvif/src/onvif.c
-    libonvif/src/cencode.c
-    libonvif/src/sha1.c
-)
-
-target_link_libraries(onvif_static PRIVATE
-    ${LIBXML2_LIBRARIES}
-)
-
-if (WIN32)
-    target_include_directories(onvif_static PUBLIC
-        libonvif/include
-        ${Iconv_INCLUDE_DIRS}
-        ${LIBXML2_INCLUDE_DIRS}
-    )
-else()
-    target_include_directories(onvif_static PUBLIC
-        libonvif/include
-        ${LIBXML2_INCLUDE_DIRS}
-    )
+if (BUILD_STATIC_LIBS)
+    add_library(onvif_static STATIC 
+        libonvif/src/onvif.c
+        libonvif/src/cencode.c
+        libonvif/src/sha1.c
+    )
+
+    target_link_libraries(onvif_static PRIVATE
+        ${LIBXML2_LIBRARIES}
+    )
+
+    if (WIN32)
+        target_include_directories(onvif_static PUBLIC
+            libonvif/include
+            ${Iconv_INCLUDE_DIRS}
+            ${LIBXML2_INCLUDE_DIRS}
+        )
+    else()
+        target_include_directories(onvif_static PUBLIC
+            libonvif/include
+            ${LIBXML2_INCLUDE_DIRS}
+        )
+    endif()
 endif()
 
 add_library(onvif SHARED
@@ -193,7 +195,7 @@ if (BUILD_GUI)
 endif()
 
 install(TARGETS onvif-util DESTINATION bin)
-if (WIN32)
+if (WIN32 OR CYGWIN)
     install(TARGETS onvif 
         LIBRARY DESTINATION lib
         ARCHIVE DESTINATION lib
@@ -204,7 +206,18 @@ else()
     install(TARGETS onvif DESTINATION "${CMAKE_INSTALL_LIBDIR}/")
 endif()
 
-install(TARGETS onvif_static DESTINATION "${CMAKE_INSTALL_LIBDIR}/")
+if (BUILD_STATIC_LIBS)
+    install(TARGETS onvif_static DESTINATION "${CMAKE_INSTALL_LIBDIR}/")
+endif()
 install(FILES libonvif/include/onvif.h DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}")
 INSTALL(FILES onvif-util/docs/onvif-util.1 DESTINATION ${CMAKE_INSTALL_PREFIX}/share/man/man1)
-INSTALL(FILES onvif-gui/docs/onvif-gui.1 DESTINATION ${CMAKE_INSTALL_PREFIX}/share/man/man1)
+if (BUILD_GUI)
+    INSTALL(FILES onvif-gui/docs/onvif-gui.1 DESTINATION ${CMAKE_INSTALL_PREFIX}/share/man/man1)
+endif()
+
+set(prefix ${CMAKE_INSTALL_PREFIX})
+set(exec_prefix ${CMAKE_INSTALL_PREFIX})
+set(libdir ${CMAKE_INSTALL_PREFIX}/lib)
+set(includedir ${CMAKE_INSTALL_PREFIX}/include)
+configure_file(${CMAKE_SOURCE_DIR}/libonvif.pc.in ${CMAKE_BINARY_DIR}/libonvif.pc @ONLY)
+install(FILES ${CMAKE_BINARY_DIR}/libonvif.pc DESTINATION ${CMAKE_INSTALL_PREFIX}/lib/pkgconfig)
--- origsrc/libonvif-1.4.1/libonvif.pc.in	1970-01-01 09:00:00.000000000 +0900
+++ src/libonvif-1.4.1/libonvif.pc.in	2022-12-02 11:56:37.623262000 +0900
@@ -0,0 +1,10 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+
+Name: libonvif
+Description: Client side implementation of the ONVIF specification
+Version: @PROJECT_VERSION@
+Libs: -L${libdir} -lonvif
+Cflags: -I${includedir}
