--- origsrc/benchmark-1.6.0/CMakeLists.txt	2021-09-07 20:18:34.000000000 +0900
+++ src/benchmark-1.6.0/CMakeLists.txt	2021-10-05 22:53:42.951884000 +0900
@@ -160,9 +160,11 @@ else()
   add_cxx_compiler_flag(-Wall)
   add_cxx_compiler_flag(-Wextra)
   add_cxx_compiler_flag(-Wshadow)
-  add_cxx_compiler_flag(-Werror RELEASE)
-  add_cxx_compiler_flag(-Werror RELWITHDEBINFO)
-  add_cxx_compiler_flag(-Werror MINSIZEREL)
+  if (NOT CYGWIN)
+    add_cxx_compiler_flag(-Werror RELEASE)
+    add_cxx_compiler_flag(-Werror RELWITHDEBINFO)
+    add_cxx_compiler_flag(-Werror MINSIZEREL)
+  endif()
   if (NOT BENCHMARK_ENABLE_TESTING)
     # Disable warning when compiling tests as gtest does not use 'override'.
     add_cxx_compiler_flag(-Wsuggest-override)
@@ -302,12 +304,18 @@ include_directories(${PROJECT_SOURCE_DIR
 # Build the targets
 add_subdirectory(src)
 
+option(USE_SYSTEM_GTEST "Use system gtest" ON)
+
 if (BENCHMARK_ENABLE_TESTING)
   enable_testing()
   if (BENCHMARK_ENABLE_GTEST_TESTS AND
       NOT (TARGET gtest AND TARGET gtest_main AND
            TARGET gmock AND TARGET gmock_main))
-    include(GoogleTest)
+    if (USE_SYSTEM_GTEST)
+      find_package(gtest)
+    else()
+      include(GoogleTest)
+    endif()
   endif()
   add_subdirectory(test)
 endif()
--- origsrc/benchmark-1.6.0/test/CMakeLists.txt	2021-09-07 20:18:34.000000000 +0900
+++ src/benchmark-1.6.0/test/CMakeLists.txt	2021-10-05 22:43:05.226205000 +0900
@@ -188,7 +188,7 @@ add_test(NAME complexity_benchmark COMMA
 if (BENCHMARK_ENABLE_GTEST_TESTS)
   macro(compile_gtest name)
     add_executable(${name} "${name}.cc")
-    target_link_libraries(${name} benchmark::benchmark
+    target_link_libraries(${name} benchmark::benchmark gtest gmock
         gmock_main ${CMAKE_THREAD_LIBS_INIT})
   endmacro(compile_gtest)
 
