--- origsrc/libnpupnp-4.1.1/Makefile.am	2021-02-04 02:07:11.000000000 +0900
+++ src/libnpupnp-4.1.1/Makefile.am	2021-06-10 17:45:00.807587400 +0900
@@ -42,7 +42,7 @@ libnpupnp_la_CXXFLAGS = -fvisibility=hid
 endif
 
 
-libnpupnp_la_LDFLAGS = \
+libnpupnp_la_LDFLAGS = -no-undefined \
 	-version-info $(LT_VERSION_NPUPNP) \
 	$(LIBNPUPNP_LIBS)
 
--- origsrc/libnpupnp-4.1.1/src/threadutil/ThreadPool.cpp	2021-02-04 02:07:11.000000000 +0900
+++ src/libnpupnp-4.1.1/src/threadutil/ThreadPool.cpp	2021-06-10 17:38:06.157634400 +0900
@@ -255,7 +255,7 @@ static int SetPolicyType(ThreadPoolAttr:
  */
 static int SetPriority(ThreadPool::ThreadPriority priority)
 {
-#if defined(_POSIX_PRIORITY_SCHEDULING) && _POSIX_PRIORITY_SCHEDULING > 0
+#if !defined(__CYGWIN__) && defined(_POSIX_PRIORITY_SCHEDULING) && _POSIX_PRIORITY_SCHEDULING > 0
     int retVal = 0;
     int currentPolicy;
     int minPriority = 0;
--- origsrc/libnpupnp-4.1.1/src/utils/netif.cpp	2021-02-06 23:57:14.000000000 +0900
+++ src/libnpupnp-4.1.1/src/utils/netif.cpp	2021-06-10 17:41:37.175854900 +0900
@@ -46,7 +46,7 @@
 #include <ifaddrs.h>
 #ifdef __linux__
 #include <netpacket/packet.h>
-#else
+#elif !defined(__CYGWIN__)
 #include <net/if_dl.h>
 #endif
 
@@ -502,7 +502,7 @@ Interfaces::Internal::Internal()
             ifit->m->sethwaddr(reinterpret_cast<const char*>(sll->sll_addr), sll->sll_halen);
         }
         break;
-#else
+#elif !defined(__CYGWIN__)
         case AF_LINK:
         {
             auto sdl = reinterpret_cast<struct sockaddr_dl*>(ifa->ifa_addr);
