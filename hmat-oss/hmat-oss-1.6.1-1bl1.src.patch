--- origsrc/hmat-oss-1.6.1/CMakeLists.txt	2020-01-28 18:38:45.000000000 +0900
+++ src/hmat-oss-1.6.1/CMakeLists.txt	2021-03-26 11:19:27.376812200 +0900
@@ -50,7 +50,7 @@ set(HMAT_SO_VERSION 1)
 # Offer the user the choice of overriding the installation directories
 set(INSTALL_LIB_DIR     lib${LIB_SUFFIX} CACHE PATH "Installation directory for libraries")
 set(INSTALL_BIN_DIR     bin              CACHE PATH "Installation directory for executables")
-set(INSTALL_INCLUDE_DIR include          CACHE PATH "Installation directory for header files")
+set(INSTALL_INCLUDE_DIR include/hmat     CACHE PATH "Installation directory for header files")
 set(INSTALL_DATA_DIR    share/hmat       CACHE PATH "Installation directory for data files")
 set(INSTALL_CMAKE_DIR   ${INSTALL_LIB_DIR}/cmake/hmat CACHE PATH "Installation directory for cmake config files")
 
@@ -368,7 +368,7 @@ macro(hmat_add_example name source)
     add_executable(${HMAT_PREFIX_EXAMPLE}${name} ${PROJECT_SOURCE_DIR}/examples/${source})
     target_link_libraries(${HMAT_PREFIX_EXAMPLE}${name} ${PROJECT_NAME})
     if (INSTALL_EXAMPLES)
-      install(TARGETS ${HMAT_PREFIX_EXAMPLE}${name} DESTINATION "${RELATIVE_INSTALL_BIN_DIR}/examples" COMPONENT Runtime)
+      install(TARGETS ${HMAT_PREFIX_EXAMPLE}${name} DESTINATION "${RELATIVE_INSTALL_BIN_DIR}" COMPONENT Runtime)
     endif ()
   endif ()
 endmacro()
@@ -451,3 +451,10 @@ if (CMAKE_VERSION VERSION_GREATER 2.8.5)
     include(FeatureSummary)
     feature_summary(WHAT ALL)
 endif ()
+
+SET(prefix ${CMAKE_INSTALL_PREFIX})
+SET(exec_prefix ${CMAKE_INSTALL_PREFIX})
+SET(libdir ${CMAKE_INSTALL_PREFIX}/lib)
+SET(includedir ${CMAKE_INSTALL_PREFIX}/include)
+CONFIGURE_FILE(${CMAKE_SOURCE_DIR}/hmat-oss.pc.in ${CMAKE_BINARY_DIR}/hmat-oss.pc @ONLY)
+INSTALL(FILES ${CMAKE_BINARY_DIR}/hmat-oss.pc DESTINATION ${CMAKE_INSTALL_PREFIX}/lib/pkgconfig)
--- origsrc/hmat-oss-1.6.1/hmat-oss.pc.in	1970-01-01 09:00:00.000000000 +0900
+++ src/hmat-oss-1.6.1/hmat-oss.pc.in	2021-03-26 11:10:54.070056500 +0900
@@ -0,0 +1,10 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+
+Name: hmat-oss
+Description: Hierarchical matrix C/C++ library
+Version: @HMAT_VERSION@
+Libs: -L${libdir} -lhmat-oss
+Cflags: -I${includedir}/hmat
--- origsrc/hmat-oss-1.6.1/src/blas_overloads.hpp	2020-01-28 18:38:45.000000000 +0900
+++ src/hmat-oss-1.6.1/src/blas_overloads.hpp	2021-03-26 10:42:21.581952900 +0900
@@ -39,6 +39,10 @@
 #include "mkl_trans.h"
 #endif
 
+#if defined(_C)
+#undef _C
+#endif
+
 namespace proxy_cblas {
 
 #if defined(OPENBLAS_COMPLEX_STRUCT) || defined(OPENBLAS_COMPLEX_C99)
--- origsrc/hmat-oss-1.6.1/src/common/my_assert.h	2020-01-28 18:38:45.000000000 +0900
+++ src/hmat-oss-1.6.1/src/common/my_assert.h	2021-03-26 10:38:27.337064600 +0900
@@ -39,7 +39,7 @@
 #  define HMAT_FUNCTION ((const char *) 0)
 #endif
 
-#if !defined (_WIN32) /* It's a UNIX system, I know this ! */
+#if !defined (_WIN32) && !defined(__CYGWIN__) /* It's a UNIX system, I know this ! */
 #include <execinfo.h>
 #include <unistd.h>
 inline static void hmat_backtrace(){
